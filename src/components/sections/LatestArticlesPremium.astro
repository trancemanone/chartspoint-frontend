---
/**
 * LatestArticlesPremium Component
 * Ultra-sophisticated أحدث المقالات (Latest Articles) Section
 *
 * An institutional-grade editorial showcase featuring:
 * - Asymmetric layout: Featured hero (6 cols) + 2x2 grid (6 cols)
 * - Featured card with glassmorphism content overlay
 * - Image gradient overlay with pillar-colored badges
 * - Premium shine effect on card hover
 * - Mobile horizontal carousel with snap scrolling
 * - WCAG AAA accessibility for ages 40-70
 *
 * Design Philosophy: Bloomberg Terminal meets Apple meets Premium Fintech
 */

import { getAllPosts, transformToArticle } from '../../lib/wordpress';
import { PILLARS, type PillarSlug } from '../../lib/types';

// Props interface
interface Props {
  maxArticles?: number;
}

const { maxArticles = 5 } = Astro.props;

// Fetch latest posts
let articles: any[] = [];
try {
  const postsResponse = await getAllPosts(maxArticles, 1);
  articles = postsResponse.data.map(transformToArticle);
} catch (error) {
  console.error('Error fetching posts for LatestArticlesPremium:', error);
}

// Get featured article and supporting articles
const featuredArticle = articles[0];
const supportingArticles = articles.slice(1, 5);

// Pillar color configurations
const pillarColorConfig: Record<string, { primary: string; muted: string; glow: string }> = {
  basics: {
    primary: '#3B82F6',
    muted: '#1E3A5F',
    glow: 'rgba(59, 130, 246, 0.3)',
  },
  indicators: {
    primary: '#F97316',
    muted: '#4A2810',
    glow: 'rgba(249, 115, 22, 0.3)',
  },
  tools: {
    primary: '#10B981',
    muted: '#0D3D2E',
    glow: 'rgba(16, 185, 129, 0.3)',
  },
  tactics: {
    primary: '#8B5CF6',
    muted: '#2E1F5C',
    glow: 'rgba(139, 92, 246, 0.3)',
  },
};

function getPillarColor(pillar: string) {
  return pillarColorConfig[pillar] || pillarColorConfig.basics;
}

function formatDate(dateStr: string): string {
  const date = new Date(dateStr);
  return date.toLocaleDateString('ar-SA', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}
---

<section
  id="latest-articles"
  class="latest-articles-section relative py-20 lg:py-28 overflow-hidden"
  aria-labelledby="latest-articles-heading"
>
  <!-- Subtle Background Pattern -->
  <div class="bg-pattern" aria-hidden="true"></div>

  <div class="container mx-auto px-4 lg:px-6 relative z-10">
    <!-- Section Header -->
    <header class="section-header text-center mb-12 lg:mb-16">
      <p class="section-overline">LATEST INSIGHTS</p>
      <h2 id="latest-articles-heading" class="section-title">
        <span class="title-word">أحدث</span>
        <span class="title-rest">المقالات</span>
      </h2>
      <div class="title-underline"></div>
      <p class="section-subtitle">
        مقالات تعليمية حديثة في التحليل الفني وإدارة المخاطر
      </p>
    </header>

    {articles.length > 0 && (
      <>
        <!-- Desktop Layout: Asymmetric Grid -->
        <div class="desktop-grid hidden lg:grid">
          <!-- Featured Article (Left Side) -->
          {featuredArticle && (
            <article class="featured-card group" data-pillar={featuredArticle.pillar}>
              <a
                href={`/${featuredArticle.pillar}/${featuredArticle.cluster}/${featuredArticle.slug}/`}
                class="featured-link"
                aria-label={`اقرأ المقال: ${featuredArticle.title}`}
              >
                <!-- Image Container -->
                <div class="featured-image-container">
                  {featuredArticle.featuredImage ? (
                    <img
                      src={featuredArticle.featuredImage.url}
                      alt={featuredArticle.featuredImage.alt || featuredArticle.title}
                      class="featured-image"
                      loading="eager"
                    />
                  ) : (
                    <div class="featured-placeholder">
                      <svg class="placeholder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                      </svg>
                    </div>
                  )}

                  <!-- Image Gradient Overlay -->
                  <div class="featured-overlay"></div>

                  <!-- Shine Effect -->
                  <div class="shine-effect"></div>
                </div>

                <!-- Glassmorphism Content Panel -->
                <div class="featured-content">
                  <!-- Pillar Badge -->
                  <span
                    class="pillar-badge"
                    style={`--badge-color: ${getPillarColor(featuredArticle.pillar).primary}; --badge-bg: ${getPillarColor(featuredArticle.pillar).muted};`}
                  >
                    {PILLARS[featuredArticle.pillar as PillarSlug]?.nameAr || featuredArticle.pillar}
                  </span>

                  <!-- Title -->
                  <h3 class="featured-title">{featuredArticle.title}</h3>

                  <!-- Excerpt -->
                  {featuredArticle.excerpt && (
                    <p class="featured-excerpt">{featuredArticle.excerpt}</p>
                  )}

                  <!-- Meta Row -->
                  <div class="featured-meta">
                    <span class="meta-date">
                      <svg class="meta-icon" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2z" clip-rule="evenodd" />
                      </svg>
                      {formatDate(featuredArticle.publishDate)}
                    </span>
                    <span class="meta-reading">
                      <svg class="meta-icon" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                      </svg>
                      {featuredArticle.readingTime} دقائق
                    </span>
                    <span class="read-more">
                      اقرأ المقال
                      <svg class="read-more-arrow" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                      </svg>
                    </span>
                  </div>
                </div>
              </a>
            </article>
          )}

          <!-- Supporting Articles Grid (Right Side) -->
          <div class="supporting-grid">
            {supportingArticles.map((article, index) => {
              const colors = getPillarColor(article.pillar);
              return (
                <article
                  class="supporting-card group"
                  data-pillar={article.pillar}
                  style={`--pillar-primary: ${colors.primary}; --pillar-glow: ${colors.glow}; --animation-delay: ${index * 80}ms;`}
                >
                  <a
                    href={`/${article.pillar}/${article.cluster}/${article.slug}/`}
                    class="supporting-link"
                    aria-label={`اقرأ المقال: ${article.title}`}
                  >
                    <!-- Accent Bar -->
                    <div class="accent-bar" style={`background: ${colors.primary};`}></div>

                    <!-- Image -->
                    <div class="supporting-image-container">
                      {article.featuredImage ? (
                        <img
                          src={article.featuredImage.url}
                          alt={article.featuredImage.alt || article.title}
                          class="supporting-image"
                          loading="lazy"
                        />
                      ) : (
                        <div class="supporting-placeholder">
                          <svg class="placeholder-icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                          </svg>
                        </div>
                      )}

                      <!-- Shine Effect -->
                      <div class="shine-effect-sm"></div>
                    </div>

                    <!-- Content -->
                    <div class="supporting-content">
                      <!-- Pillar Badge -->
                      <span
                        class="pillar-badge-sm"
                        style={`color: ${colors.primary}; background: ${colors.muted}20;`}
                      >
                        {PILLARS[article.pillar as PillarSlug]?.nameAr || article.pillar}
                      </span>

                      <!-- Title -->
                      <h3 class="supporting-title">{article.title}</h3>

                      <!-- Meta -->
                      <div class="supporting-meta">
                        <span class="meta-reading-sm">
                          {article.readingTime} دقائق للقراءة
                        </span>
                      </div>
                    </div>
                  </a>
                </article>
              );
            })}
          </div>
        </div>

        <!-- Mobile Carousel -->
        <div class="mobile-carousel lg:hidden">
          <div class="carousel-track">
            {articles.map((article, index) => {
              const colors = getPillarColor(article.pillar);
              return (
                <article
                  class="carousel-card"
                  data-pillar={article.pillar}
                  style={`--pillar-primary: ${colors.primary};`}
                >
                  <a
                    href={`/${article.pillar}/${article.cluster}/${article.slug}/`}
                    class="carousel-link"
                    aria-label={`اقرأ المقال: ${article.title}`}
                  >
                    <!-- Image -->
                    <div class="carousel-image-container">
                      {article.featuredImage ? (
                        <img
                          src={article.featuredImage.url}
                          alt={article.featuredImage.alt || article.title}
                          class="carousel-image"
                          loading={index === 0 ? 'eager' : 'lazy'}
                        />
                      ) : (
                        <div class="carousel-placeholder">
                          <svg class="placeholder-icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                          </svg>
                        </div>
                      )}

                      <!-- Pillar Badge Overlay -->
                      <span
                        class="carousel-badge"
                        style={`background: ${colors.primary};`}
                      >
                        {PILLARS[article.pillar as PillarSlug]?.nameAr || article.pillar}
                      </span>
                    </div>

                    <!-- Content -->
                    <div class="carousel-content">
                      <h3 class="carousel-title">{article.title}</h3>
                      <div class="carousel-meta">
                        <span>{article.readingTime} دقائق</span>
                      </div>
                    </div>
                  </a>
                </article>
              );
            })}
          </div>

          <!-- Carousel Dots -->
          <div class="carousel-dots" role="tablist" aria-label="اختيار المقال">
            {articles.map((_, index) => (
              <button
                class={`carousel-dot ${index === 0 ? 'active' : ''}`}
                data-index={index}
                role="tab"
                aria-selected={index === 0 ? 'true' : 'false'}
                aria-label={`المقال ${index + 1}`}
              />
            ))}
          </div>
        </div>

        <!-- View All Link -->
        <div class="view-all-container">
          <a href="/basics/" class="view-all-link">
            <span>استعرض جميع المقالات</span>
            <svg class="view-all-arrow" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
            </svg>
          </a>
        </div>
      </>
    )}

    {articles.length === 0 && (
      <div class="empty-state">
        <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" />
        </svg>
        <p>لا توجد مقالات حالياً</p>
      </div>
    )}
  </div>
</section>

<style>
  /* ═══════════════════════════════════════════════════════════════════════════════
     CSS CUSTOM PROPERTIES (Design Tokens)
     ═══════════════════════════════════════════════════════════════════════════════ */

  .latest-articles-section {
    /* Base Colors */
    --white: #FFFFFF;
    --slate-50: #F8FAFC;
    --slate-100: #F1F5F9;
    --slate-200: #E2E8F0;
    --slate-300: #CBD5E1;
    --slate-400: #94A3B8;
    --slate-500: #64748B;
    --slate-600: #475569;
    --slate-700: #334155;
    --slate-800: #1E293B;
    --slate-900: #0F172A;

    /* Accent */
    --teal-500: #0891B2;
    --teal-400: #22D3EE;

    /* Spacing */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-8: 32px;

    /* Radius */
    --radius-md: 6px;
    --radius-lg: 8px;
    --radius-xl: 12px;
    --radius-2xl: 16px;

    /* Motion */
    --duration-fast: 150ms;
    --duration-normal: 220ms;
    --duration-slow: 350ms;
    --ease-out: cubic-bezier(0.16, 1, 0.3, 1);

    /* Background */
    background: var(--white);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     BACKGROUND PATTERN
     ═══════════════════════════════════════════════════════════════════════════════ */

  .bg-pattern {
    position: absolute;
    inset: 0;
    opacity: 0.4;
    background-image: radial-gradient(circle at 1px 1px, var(--slate-200) 1px, transparent 0);
    background-size: 32px 32px;
    pointer-events: none;
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     SECTION HEADER
     ═══════════════════════════════════════════════════════════════════════════════ */

  .section-header {
    max-width: 640px;
    margin-left: auto;
    margin-right: auto;
  }

  .section-overline {
    font-family: 'Tajawal', sans-serif;
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--teal-500);
    margin-bottom: var(--space-4);
  }

  .section-title {
    font-family: 'Noto Kufi Arabic', sans-serif;
    font-size: clamp(1.75rem, 5vw, 2.5rem);
    font-weight: 700;
    line-height: 1.3;
    color: var(--slate-900);
    margin-bottom: var(--space-2);
  }

  .title-word {
    position: relative;
    display: inline;
  }

  .title-word::after {
    content: '';
    position: absolute;
    bottom: -2px;
    right: 0;
    width: 100%;
    height: 4px;
    background: var(--teal-500);
    border-radius: 2px;
  }

  .title-rest {
    margin-right: var(--space-2);
  }

  .title-underline {
    width: 200px;
    height: 1px;
    background: linear-gradient(to left, transparent, var(--teal-500), transparent);
    margin: var(--space-5) auto;
    opacity: 0.3;
  }

  .section-subtitle {
    font-family: 'Tajawal', sans-serif;
    font-size: 1.125rem;
    line-height: 1.75;
    color: var(--slate-600);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     DESKTOP GRID
     ═══════════════════════════════════════════════════════════════════════════════ */

  /* Desktop grid - hidden on mobile, shown on lg+ */
  .desktop-grid {
    display: none;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-6);
    max-width: 1200px;
    margin: 0 auto;
  }

  @media (min-width: 1024px) {
    .desktop-grid {
      display: grid;
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     FEATURED CARD
     ═══════════════════════════════════════════════════════════════════════════════ */

  .featured-card {
    position: relative;
    border-radius: var(--radius-2xl);
    overflow: hidden;
    background: var(--slate-900);
    box-shadow:
      0 4px 6px -1px rgba(15, 23, 42, 0.1),
      0 2px 4px -2px rgba(15, 23, 42, 0.1);
    transition: transform var(--duration-normal) var(--ease-out),
                box-shadow var(--duration-normal) var(--ease-out);
  }

  .featured-card:hover {
    transform: translateY(-4px);
    box-shadow:
      0 20px 25px -5px rgba(15, 23, 42, 0.15),
      0 8px 10px -6px rgba(15, 23, 42, 0.1);
  }

  .featured-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .featured-link:focus {
    outline: none;
  }

  .featured-card:focus-within {
    box-shadow: 0 0 0 3px var(--white), 0 0 0 6px var(--teal-500);
  }

  .featured-image-container {
    position: relative;
    aspect-ratio: 4 / 3;
    overflow: hidden;
  }

  .featured-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--duration-slow) var(--ease-out);
  }

  .featured-card:hover .featured-image {
    transform: scale(1.03);
  }

  .featured-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--slate-800);
  }

  .placeholder-icon {
    width: 64px;
    height: 64px;
    color: var(--slate-600);
  }

  .featured-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to top,
      rgba(15, 23, 42, 0.95) 0%,
      rgba(15, 23, 42, 0.6) 40%,
      rgba(15, 23, 42, 0.1) 100%
    );
  }

  /* Shine Effect */
  .shine-effect {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      105deg,
      transparent 40%,
      rgba(255, 255, 255, 0.1) 45%,
      rgba(255, 255, 255, 0.2) 50%,
      rgba(255, 255, 255, 0.1) 55%,
      transparent 60%
    );
    transform: translateX(-100%);
    transition: transform 0.6s ease;
    pointer-events: none;
  }

  .featured-card:hover .shine-effect {
    transform: translateX(100%);
  }

  /* Featured Content */
  .featured-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--space-6);
    z-index: 10;
  }

  .pillar-badge {
    display: inline-flex;
    align-items: center;
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-md);
    font-family: 'Tajawal', sans-serif;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--badge-color);
    background: var(--badge-bg);
    margin-bottom: var(--space-3);
  }

  .featured-title {
    font-family: 'Noto Kufi Arabic', sans-serif;
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1.4;
    color: var(--white);
    margin-bottom: var(--space-3);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .featured-excerpt {
    font-family: 'Tajawal', sans-serif;
    font-size: 0.9375rem;
    line-height: 1.6;
    color: var(--slate-300);
    margin-bottom: var(--space-4);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .featured-meta {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    font-family: 'Tajawal', sans-serif;
    font-size: 0.8125rem;
    color: var(--slate-400);
  }

  .meta-date,
  .meta-reading {
    display: flex;
    align-items: center;
    gap: var(--space-1);
  }

  .meta-icon {
    width: 14px;
    height: 14px;
  }

  .read-more {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    margin-right: auto;
    color: var(--teal-400);
    font-weight: 500;
    transition: gap var(--duration-fast) var(--ease-out);
  }

  .featured-card:hover .read-more {
    gap: var(--space-2);
  }

  .read-more-arrow {
    width: 16px;
    height: 16px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     SUPPORTING GRID
     ═══════════════════════════════════════════════════════════════════════════════ */

  .supporting-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-5);
  }

  .supporting-card {
    position: relative;
    border-radius: var(--radius-xl);
    background: var(--white);
    border: 1px solid var(--slate-200);
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(15, 23, 42, 0.04);
    transition: transform var(--duration-normal) var(--ease-out),
                box-shadow var(--duration-normal) var(--ease-out),
                border-color var(--duration-normal) var(--ease-out);
    animation: card-enter 0.4s var(--ease-out) forwards;
    animation-delay: var(--animation-delay);
    opacity: 0;
  }

  @keyframes card-enter {
    from {
      opacity: 0;
      transform: translateY(16px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .supporting-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px -5px rgba(15, 23, 42, 0.08);
    border-color: var(--pillar-primary);
  }

  .supporting-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .supporting-link:focus {
    outline: none;
  }

  .supporting-card:focus-within {
    box-shadow: 0 0 0 3px var(--white), 0 0 0 6px var(--teal-500);
  }

  /* Accent Bar */
  .accent-bar {
    position: absolute;
    top: 0;
    right: 0;
    width: 3px;
    height: 100%;
    transition: width var(--duration-fast) var(--ease-out);
    z-index: 10;
  }

  .supporting-card:hover .accent-bar {
    width: 4px;
  }

  .supporting-image-container {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
  }

  .supporting-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--duration-slow) var(--ease-out);
  }

  .supporting-card:hover .supporting-image {
    transform: scale(1.03);
  }

  .supporting-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--slate-100);
  }

  .placeholder-icon-sm {
    width: 40px;
    height: 40px;
    color: var(--slate-400);
  }

  .shine-effect-sm {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      105deg,
      transparent 40%,
      rgba(255, 255, 255, 0.2) 45%,
      rgba(255, 255, 255, 0.3) 50%,
      rgba(255, 255, 255, 0.2) 55%,
      transparent 60%
    );
    transform: translateX(-100%);
    transition: transform 0.5s ease;
    pointer-events: none;
  }

  .supporting-card:hover .shine-effect-sm {
    transform: translateX(100%);
  }

  .supporting-content {
    padding: var(--space-4);
  }

  .pillar-badge-sm {
    display: inline-flex;
    padding: 2px var(--space-2);
    border-radius: var(--radius-md);
    font-family: 'Tajawal', sans-serif;
    font-size: 0.6875rem;
    font-weight: 600;
    margin-bottom: var(--space-2);
  }

  .supporting-title {
    font-family: 'Noto Kufi Arabic', sans-serif;
    font-size: 0.9375rem;
    font-weight: 600;
    line-height: 1.5;
    color: var(--slate-900);
    margin-bottom: var(--space-2);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .supporting-card:hover .supporting-title {
    color: var(--pillar-primary);
  }

  .supporting-meta {
    font-family: 'Tajawal', sans-serif;
    font-size: 0.75rem;
    color: var(--slate-500);
  }

  .meta-reading-sm {
    display: flex;
    align-items: center;
    gap: var(--space-1);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     MOBILE CAROUSEL
     ═══════════════════════════════════════════════════════════════════════════════ */

  /* Mobile carousel - shown on mobile, hidden on lg+ */
  .mobile-carousel {
    display: block;
    position: relative;
  }

  @media (min-width: 1024px) {
    .mobile-carousel {
      display: none;
    }
  }

  .carousel-track {
    display: flex;
    gap: var(--space-4);
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    padding-bottom: var(--space-4);
    /* Hide scrollbar */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .carousel-track::-webkit-scrollbar {
    display: none;
  }

  .carousel-card {
    flex: 0 0 280px;
    scroll-snap-align: start;
    border-radius: var(--radius-xl);
    background: var(--white);
    border: 1px solid var(--slate-200);
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(15, 23, 42, 0.06);
  }

  .carousel-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .carousel-image-container {
    position: relative;
    aspect-ratio: 16 / 10;
    overflow: hidden;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--slate-100);
  }

  .carousel-badge {
    position: absolute;
    top: var(--space-3);
    right: var(--space-3);
    padding: 2px var(--space-2);
    border-radius: var(--radius-md);
    font-family: 'Tajawal', sans-serif;
    font-size: 0.6875rem;
    font-weight: 600;
    color: var(--white);
  }

  .carousel-content {
    padding: var(--space-4);
  }

  .carousel-title {
    font-family: 'Noto Kufi Arabic', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.5;
    color: var(--slate-900);
    margin-bottom: var(--space-2);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .carousel-meta {
    font-family: 'Tajawal', sans-serif;
    font-size: 0.75rem;
    color: var(--slate-500);
  }

  /* Carousel Dots */
  .carousel-dots {
    display: flex;
    justify-content: center;
    gap: var(--space-2);
    margin-top: var(--space-4);
  }

  .carousel-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--slate-300);
    border: none;
    padding: 0;
    cursor: pointer;
    transition: background var(--duration-fast) var(--ease-out),
                transform var(--duration-fast) var(--ease-out);
  }

  .carousel-dot:hover {
    background: var(--slate-400);
  }

  .carousel-dot.active {
    background: var(--teal-500);
    transform: scale(1.2);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     VIEW ALL LINK
     ═══════════════════════════════════════════════════════════════════════════════ */

  .view-all-container {
    display: flex;
    justify-content: center;
    margin-top: var(--space-8);
  }

  .view-all-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-6);
    font-family: 'Tajawal', sans-serif;
    font-size: 0.9375rem;
    font-weight: 500;
    color: var(--teal-500);
    text-decoration: none;
    border: 1px solid var(--teal-500);
    border-radius: var(--radius-lg);
    transition: all var(--duration-fast) var(--ease-out);
  }

  .view-all-link:hover {
    background: var(--teal-500);
    color: var(--white);
    gap: var(--space-3);
  }

  .view-all-link:focus {
    outline: none;
    box-shadow: 0 0 0 3px var(--white), 0 0 0 6px var(--teal-500);
  }

  .view-all-arrow {
    width: 18px;
    height: 18px;
    transition: transform var(--duration-fast) var(--ease-out);
  }

  .view-all-link:hover .view-all-arrow {
    transform: translateX(-4px);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     EMPTY STATE
     ═══════════════════════════════════════════════════════════════════════════════ */

  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-8);
    text-align: center;
    color: var(--slate-500);
  }

  .empty-icon {
    width: 64px;
    height: 64px;
    margin-bottom: var(--space-4);
    color: var(--slate-400);
  }

  /* ═══════════════════════════════════════════════════════════════════════════════
     REDUCED MOTION
     ═══════════════════════════════════════════════════════════════════════════════ */

  @media (prefers-reduced-motion: reduce) {
    .featured-card,
    .supporting-card,
    .featured-image,
    .supporting-image,
    .shine-effect,
    .shine-effect-sm,
    .accent-bar,
    .read-more,
    .carousel-dot,
    .view-all-link,
    .view-all-arrow {
      animation: none;
      transition: none;
    }

    .supporting-card {
      opacity: 1;
    }
  }
</style>

<script>
  // Mobile carousel dot navigation
  document.addEventListener('DOMContentLoaded', () => {
    const track = document.querySelector('.carousel-track');
    const dots = document.querySelectorAll('.carousel-dot');

    if (!track || dots.length === 0) return;

    // Update active dot on scroll
    track.addEventListener('scroll', () => {
      const scrollPosition = track.scrollLeft;
      const cardWidth = 280 + 16; // card width + gap
      const activeIndex = Math.round(scrollPosition / cardWidth);

      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === activeIndex);
        dot.setAttribute('aria-selected', index === activeIndex ? 'true' : 'false');
      });
    });

    // Click on dot to scroll
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        const cardWidth = 280 + 16;
        track.scrollTo({
          left: index * cardWidth,
          behavior: 'smooth'
        });
      });
    });
  });
</script>
