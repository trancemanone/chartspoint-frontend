---
/**
 * Homepage - chartspoint.com
 * Technical Analysis Education Platform
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllPosts, transformToArticle } from '../lib/wordpress';
import { PILLARS, CLUSTERS, type PillarSlug } from '../lib/types';

// Fetch latest posts for featured section
let featuredArticles: any[] = [];
try {
  const postsResponse = await getAllPosts(6, 1);
  featuredArticles = postsResponse.data.map(transformToArticle);
} catch (error) {
  console.error('Error fetching posts:', error);
}

// Get pillar data with clusters
const pillarData = Object.entries(PILLARS).map(([slug, pillar]) => {
  const clusters = CLUSTERS.filter(c => c.pillar === slug as PillarSlug);
  return {
    ...pillar,
    clusterCount: clusters.length,
    clusters: clusters.slice(0, 4),
  };
});

// Stats
const stats = [
  { value: '4', label: 'محاور رئيسية' },
  { value: '15', label: 'مجموعة تخصصية' },
  { value: '0+', label: 'مقال تعليمي' },
];

// Homepage schema
const homeSchema = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "تشارتس بوينت",
  "description": "تعليم التحليل الفني للأسواق المالية",
  "url": "https://chartspoint.com",
  "inLanguage": "ar",
});
---

<BaseLayout
  title="تشارتس بوينت - تعليم التحليل الفني"
  description="تعليم التحليل الفني بعيدا عن الضجيج. فهم الشارت قبل مطاردة الإشارات. التحليل الفني كمنهج لا كحظ."
  schema={homeSchema}
>
  <!-- Hero Section -->
  <section class="hero-section relative py-24 lg:py-36 overflow-hidden">
    <!-- Background -->
    <div class="absolute inset-0 bg-gradient-to-br from-[#102941] via-[#0d2236] to-[#071828]"></div>

    <!-- Gold Glow -->
    <div class="absolute top-0 left-1/4 w-[600px] h-[600px] bg-gradient-radial from-[#d5a035]/15 via-[#d5a035]/5 to-transparent rounded-full blur-3xl"></div>

    <!-- Content -->
    <div class="container mx-auto px-4 relative z-10">
      <div class="max-w-4xl mx-auto text-center">
        <!-- Badge -->
        <div class="inline-flex items-center gap-2 px-4 py-2 mb-8 bg-[#d5a035]/10 border border-[#d5a035]/30 rounded-full">
          <span class="w-2 h-2 rounded-full bg-[#d5a035] animate-pulse"></span>
          <span class="text-[#d5a035] text-sm font-medium">منصة تعليمية للتحليل الفني</span>
        </div>

        <!-- Main Heading -->
        <h1 class="text-4xl lg:text-6xl font-bold text-white mb-6 leading-tight font-heading">
          تعليم التحليل الفني
          <span class="block text-[#d5a035]">بعيدا عن الضجيج</span>
        </h1>

        <!-- Subheading -->
        <p class="text-xl lg:text-2xl text-gray-300 mb-10 max-w-2xl mx-auto leading-relaxed">
          نحو فهم أعمق لكيف تتحرك الأسعار، ولماذا تفشل الإشارات، وكيف يدير المتداول المخاطر قبل التفكير في الأرباح
        </p>

        <!-- CTA Buttons -->
        <div class="flex flex-wrap justify-center gap-4">
          <a href="/basics/" class="inline-flex items-center gap-2 px-8 py-4 bg-[#d5a035] text-[#102941] font-bold rounded-xl hover:bg-[#e8bc5a] transition-all">
            ابدأ من الأساسيات
            <svg class="w-5 h-5 rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
          </a>
          <a href="/indicators/" class="inline-flex items-center gap-2 px-8 py-4 border border-white/30 text-white font-semibold rounded-xl hover:bg-white/10 transition-all">
            استكشف المؤشرات
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Pillars Section -->
  <section class="py-20 bg-surface-page">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <h2 class="text-3xl lg:text-4xl font-bold text-navy-900 mb-4 font-heading">
          المحاور الأربعة للتعليم
        </h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          بنية تعليمية منظمة تأخذك من الأساسيات إلى التطبيق العملي
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        {pillarData.map((pillar) => (
          <a
            href={`/${pillar.slug}/`}
            class="group p-6 bg-white rounded-2xl border border-gray-100 hover:border-gray-200 hover:shadow-lg transition-all duration-300"
          >
            <!-- Pillar Color Bar -->
            <div class="w-12 h-1 rounded-full mb-4" style={`background-color: ${pillar.color}`}></div>

            <!-- Pillar Name -->
            <h3 class="text-xl font-bold text-navy-900 mb-2 font-heading group-hover:text-opacity-80">
              {pillar.nameAr}
            </h3>

            <!-- Description -->
            <p class="text-gray-600 mb-4 text-sm leading-relaxed">
              {pillar.description}
            </p>

            <!-- Cluster Count -->
            <div class="flex items-center gap-2 text-sm text-gray-500">
              <span class="font-semibold" style={`color: ${pillar.color}`}>{pillar.clusterCount}</span>
              <span>مجموعات</span>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="py-16 bg-navy-900">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8 text-center">
        {stats.map((stat) => (
          <div class="p-6">
            <div class="text-4xl lg:text-5xl font-bold text-[#d5a035] mb-2">{stat.value}</div>
            <div class="text-gray-300">{stat.label}</div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Clusters Overview -->
  <section class="py-20 bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <h2 class="text-3xl lg:text-4xl font-bold text-navy-900 mb-4 font-heading">
          استكشف المحتوى
        </h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          محتوى تعليمي منظم حسب الموضوع والمستوى
        </p>
      </div>

      <div class="space-y-12">
        {pillarData.map((pillar) => (
          <div class="p-6 rounded-2xl border border-gray-100">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-10 h-10 rounded-xl flex items-center justify-center" style={`background-color: ${pillar.color}20`}>
                <div class="w-3 h-3 rounded-full" style={`background-color: ${pillar.color}`}></div>
              </div>
              <h3 class="text-xl font-bold text-navy-900 font-heading">{pillar.nameAr}</h3>
            </div>

            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
              {pillar.clusters.map((cluster) => (
                <a
                  href={`/${pillar.slug}/${cluster.slug}/`}
                  class="p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors"
                >
                  <span class="text-navy-800 font-medium">{cluster.nameAr}</span>
                </a>
              ))}
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Risk Disclaimer -->
  <section class="py-8 bg-gray-50 border-t border-gray-200">
    <div class="container mx-auto px-4">
      <p class="text-center text-sm text-gray-500 max-w-3xl mx-auto">
        <strong>تنبيه:</strong> المحتوى المقدم في هذا الموقع تعليمي فقط ولا يعتبر نصيحة استثمارية. التداول في الأسواق المالية ينطوي على مخاطر وقد تخسر رأس مالك. تأكد من فهمك الكامل للمخاطر قبل اتخاذ أي قرار.
      </p>
    </div>
  </section>
</BaseLayout>

<style>
  .bg-gradient-radial {
    background: radial-gradient(circle, var(--tw-gradient-from) 0%, var(--tw-gradient-to) 70%);
  }
</style>
